<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Causal Compiler v5.0</title>

<style>
body{
    background:#050b18;
    color:#8aa2ff;
    font-family:monospace;
    padding:20px;
}
h2{
    text-align:center;
    letter-spacing:2px;
}
textarea{
    width:100%;
    height:130px;
    background:#0d162b;
    color:#ffffff;
    border:1px solid #1f2a44;
    padding:10px;
    font-size:16px;
}
button{
    margin-top:10px;
    padding:10px 20px;
    background:#1f2a44;
    color:#8aa2ff;
    border:none;
    cursor:pointer;
    font-weight:bold;
}
button:hover{
    background:#2b3a66;
}
.output{
    margin-top:20px;
    padding:15px;
    background:#0d162b;
    border:1px solid #1f2a44;
    white-space:pre-wrap;
    min-height:80px;
}
.small{
    font-size:12px;
    color:#5a6db3;
}
</style>
</head>

<body>

<h2>CAUSAL COMPILER v5.0</h2>

<div class="small">Step 1: Input (English)</div>
<textarea id="inputText" placeholder="Enter English sentence..."></textarea>
<button onclick="compileText()">Compile</button>

<div class="small" style="margin-top:20px;">Step 3: Causal Language</div>
<div class="output" id="outputBox"></div>

<script type="module">

import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

const API_KEY = "PUT_YOUR_API_KEY_HERE";
const genAI = new GoogleGenerativeAI(API_KEY);

async function compileText(){

    const input = document.getElementById("inputText").value.trim();
    const outputBox = document.getElementById("outputBox");

    if(!input){
        outputBox.textContent = "Please enter a sentence.";
        return;
    }

    outputBox.textContent = "Processing...";

    try{

        const model = genAI.getGenerativeModel({
            model: "gemini-2.5-flash"
        });

        // üî• Ÿæÿ±ÿßŸÖŸæ ÿ≠ÿ±ŸÅŸá‚Äåÿß€å ÿ¥ÿßŸÖŸÑ ŸÇŸàÿßÿπÿØ ÿ≤ÿ®ÿßŸÜ€å
        const prompt = `
You are a linguistic transformation engine.

TASK:
Transform the input English sentence into a structured CAUSAL LANGUAGE format.

STRICT RULES:
1. Identify SUBJECT
2. Identify ACTION (main verb)
3. Identify OBJECT (if exists)
4. Identify CAUSE (why it happens)
5. Identify EFFECT (result of action)
6. Do NOT explain anything.
7. Output MUST be valid JSON only.
8. No extra commentary.
9. No markdown.
10. No text outside JSON.

JSON STRUCTURE REQUIRED:

{
  "subject": "",
  "action": "",
  "object": "",
  "cause": "",
  "effect": "",
  "causal_language": ""
}

CAUSAL_LANGUAGE RULE:
Reconstruct the sentence in explicit cause-effect logical form:
"Because [CAUSE], [SUBJECT] [ACTION] [OBJECT], therefore [EFFECT]."

If cause is implicit, infer a logical cause.
If effect is implicit, infer a logical effect.

INPUT:
"${input}"
`;

        const result = await model.generateContent({
            contents: [{ role: "user", parts: [{ text: prompt }] }],
            generationConfig: {
                responseMimeType: "application/json",
                temperature: 0.2
            }
        });

        const responseText = result.response.text();

        let parsed;

        try{
            parsed = JSON.parse(responseText);
        }catch{
            // ÿß⁄Øÿ± ŸÖÿ™ŸÜ ÿßÿ∂ÿßŸÅ€å ÿ®ŸàÿØ JSON ÿ±ÿß ÿßÿ≥ÿ™ÿÆÿ±ÿßÿ¨ ŸÖ€å‚Äå⁄©ŸÜ€åŸÖ
            const match = responseText.match(/\{[\s\S]*\}/);
            if(match){
                parsed = JSON.parse(match[0]);
            }else{
                throw new Error("Model did not return valid JSON.");
            }
        }

        outputBox.textContent = parsed.causal_language;

    }catch(error){
        console.error(error);
        outputBox.textContent = "System Error: " + error.message;
    }
}

window.compileText = compileText;

</script>

</body>
</html>
